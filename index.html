<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Retro Yahoo — Local Demo</title>
  <style>
    /* Retro 1990s directory/search engine styling */
    :root{--bg:#F6EAF8;--accent:#7B1FA2;--muted:#5b3b6b}
    html,body{height:100%;margin:0;font-family: 'Georgia', 'Times New Roman', serif;background:var(--bg);color:#222}
    .page{max-width:980px;margin:36px auto;padding:24px;border:6px solid #f2d9ff;background:#fff;box-shadow:0 6px 0 rgba(0,0,0,0.06)}

    /* Logo */
    header{display:flex;align-items:center;gap:18px}
    .logo{font-size:68px;font-weight:700;color:var(--accent);letter-spacing:2px;font-family: 'Trebuchet MS','Helvetica',sans-serif}
    .tag{font-size:14px;color:var(--muted);margin-top:6px}

    /* search box */
    .search-row{display:flex;gap:10px;margin:18px 0}
    .search-input{flex:1;padding:12px 14px;font-size:18px;border:2px solid #caa0d8;border-right:0;border-radius:6px 0 0 6px}
    .search-btn{padding:12px 18px;font-size:18px;background:var(--accent);color:#fff;border:none;border-radius:0 6px 6px 0;cursor:pointer}
    .search-btn:active{transform:translateY(1px)}

    /* layout */
    .content{display:flex;gap:24px}
    nav{width:220px}
    nav h3{margin:6px 0 10px;font-size:14px;color:var(--muted)}
    .cat-list{list-style:none;padding:0;margin:0}
    .cat-list li{padding:6px 8px;border-bottom:1px dotted #eee}
    .cat-list a{color:#1a0dab;text-decoration:none}

    main{flex:1}
    .directory{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .card{padding:12px;border:1px solid #f0d9f8;border-radius:6px;background:#faf5fb}
    .card h4{margin:0 0 6px;font-size:16px;color:var(--accent)}
    .card p{margin:0;font-size:14px;color:#333}
    .meta{font-size:12px;color:#666;margin-top:8px}

    /* results */
    .results{margin-top:18px}
    .result{padding:12px 0;border-bottom:1px solid #eee}
    .result a.title{font-size:18px;color:#1a0dab;text-decoration:none}
    .result .desc{font-size:14px;color:#333;margin-top:6px}

    footer{margin-top:18px;font-size:12px;color:#666}

    /* tiny retro touches */
    .search-hints{font-size:13px;color:#6b4a7a;margin-top:8px}
    .small-btn{display:inline-block;padding:6px 8px;border:1px solid #d7b5e6;border-radius:4px;background:#fff;margin-right:6px;font-size:13px}

    @media(max-width:720px){.directory{grid-template-columns:1fr}.logo{font-size:44px}}
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div>
        <div class="logo">YahoRetro</div>
        <div class="tag">A simple directory & search demo — 1995 vibes</div>
      </div>
      <div style="margin-left:auto;text-align:right">
        <div style="font-size:12px;color:#333">Welcome to the retro web</div>
        <div style="font-size:11px;color:#6b4a7a">Local demo — no server needed</div>
      </div>
    </header>

    <div class="search-row">
      <input id="q" class="search-input" placeholder="Search the web or this directory..." autocomplete="off" />
      <button id="searchBtn" class="search-btn">Search</button>
      <button id="webBtn" class="small-btn" title="Search live web">Search Web</button>
    </div>
    <div class="search-hints">Tip: try queries like "games", "news", or pick a category on the left.</div>

    <div class="content">
      <nav>
        <h3>Categories</h3>
        <ul class="cat-list" id="categories">
          <!-- populated by JS -->
        </ul>

        <h3 style="margin-top:12px">Directory</h3>
        <div class="directory" id="directory">
          <!-- populated by JS -->
        </div>
      </nav>

      <main>
        <div id="results" class="results">
          <!-- results appear here -->
        </div>
      </main>
    </div>

    <footer>This is a frontend-only demo. Use it as a starting point for building a real search engine or directory.</footer>
  </div>

  <script>
    // Loads all JSON files in /content as pages
    // Requires serving the folder through a local server (HTML cannot read local files directly)

    let data = [];

    async function loadContentFolder(){
      try{
        // Expecting an index.json listing files
        const list = await fetch('content/index.json').then(r=>r.json());
        const pages = await Promise.all(list.map(f=>fetch('content/'+f).then(r=>r.json())));
        data = pages;
        initUI();
      }catch(e){
        console.error(e);
        results.innerHTML = '<div style="color:red">Failed to load content folder. Make sure you are using a local server.</div>';
      }
    }

    function initUI(){
      const categories = [...new Set(data.map(d=>d.category))];
      const catList = document.getElementById('categories');
      catList.innerHTML='';
      categories.forEach(cat=>{
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = '#'; a.textContent = cat;
        a.addEventListener('click', (e)=>{e.preventDefault(); doSearch(cat, true)});
        li.appendChild(a);
        catList.appendChild(li);
      });

      const directory = document.getElementById('directory');
      directory.innerHTML='';
      data.forEach(d=>{
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `<h4>${escapeHtml(d.title)}</h4><p>${escapeHtml(d.desc)}</p><div class='meta'>Category: ${escapeHtml(d.category)}</div>`;
        directory.appendChild(card);
      });

      doSearch('');
    }

    const qInput = document.getElementById('q');
    const results = document.getElementById('results');
    document.getElementById('searchBtn').addEventListener('click', ()=>doSearch(qInput.value||''));
    qInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') doSearch(qInput.value||''); });

    function doSearch(query, isCategory=false){
      const q = (query||'').trim().toLowerCase();
      results.innerHTML = '';
      let hits = [];
      if(!q){
        results.innerHTML = '<div style="color:#666">No query entered — showing top picks.</div>';
        data.slice(0,4).forEach(d=>appendResult(d));
        return;
      }
      if(isCategory){ hits = data.filter(d=>d.category.toLowerCase()===q); }
      else{
        hits = data.filter(d=>(d.title.toLowerCase().includes(q)||d.desc.toLowerCase().includes(q)||d.category.toLowerCase().includes(q)));
      }
      if(hits.length===0){ results.innerHTML = `<div>No results for "${escapeHtml(query)}"</div>`; }
      else hits.forEach(h=>appendResult(h));
    }

    function appendResult(item){
      const div = document.createElement('div'); div.className='result';
      div.innerHTML = `<a class='title' href='${escapeHtml(item.url)}' target='_blank'>${escapeHtml(item.title)}</a>`+
                      `<div class='desc'>${escapeHtml(item.desc)}</div>`+
                      `<div class='meta'>Category: ${escapeHtml(item.category)}</div>`;
      results.appendChild(div);
    }

    function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    loadContentFolder();
  </script>
</body>
</html>
